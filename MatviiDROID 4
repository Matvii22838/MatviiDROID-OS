print("loading...")
os.execute("sleep 5")

-- MatviiDROID 4.1

-- Ð¢Ð°Ð±Ð»Ð¸Ñ†Ñ Ð½Ð°Ð»Ð°ÑˆÑ‚ÑƒÐ²Ð°Ð½ÑŒ
settings = {
    textColor = "default",
    sound = false,
    language = "uk"
}

function colorPrint(text)
    if settings.textColor == "red" then
        print("\27[31m"..text.."\27[0m")
    elseif settings.textColor == "green" then
        print("\27[32m"..text.."\27[0m")
    else
        print(text)
    end
end

function text(key)
    local t = {
        ["main_title"] = {uk="MatviiDROID 4.1", en="MatviiDROID 4.1"},
        ["menu_settings"] = {uk="ÐÐ°Ð»Ð°ÑˆÑ‚ÑƒÐ²Ð°Ð½Ð½Ñ", en="Settings"},
        ["menu_calc"] = {uk="ÐšÐ°Ð»ÑŒÐºÑƒÐ»ÑÑ‚Ð¾Ñ€", en="Calculator"},
        ["menu_info"] = {uk="Ð†Ð½Ñ„Ð¾Ñ€Ð¼Ð°Ñ†Ñ–Ñ Ð¿Ñ€Ð¾ ÑÐ¸ÑÑ‚ÐµÐ¼Ñƒ", en="System Info"},
        ["menu_games"] = {uk="ÐœÑ–Ð½Ñ–-Ñ–Ð³Ñ€Ð¸", en="Mini Games"},
        ["menu_files"] = {uk="ÐŸÑ€Ð¾Ð²Ñ–Ð´Ð½Ð¸Ðº", en="File Explorer"},
        ["menu_notes"] = {uk="ÐÐ¾Ñ‚Ð°Ñ‚ÐºÐ¸", en="Notes"},
        ["cmd_invalid"] = {uk="ÐÐµÐ²Ñ–Ñ€Ð½Ð° ÐºÐ¾Ð¼Ð°Ð½Ð´Ð°", en="Invalid command"},
        ["back"] = {uk="back - ÐŸÐ¾Ð²ÐµÑ€Ð½ÑƒÑ‚Ð¸ÑÑŒ Ð½Ð° Ð³Ð¾Ð»Ð¾Ð²Ð½Ðµ Ð¼ÐµÐ½ÑŽ", en="back - Return to main menu"},
        ["developer"] = {uk="Ð Ð¾Ð·Ñ€Ð¾Ð±Ð½Ð¸Ðº: ÐœÐ°Ñ‚Ð²Ñ–Ð¹ ÐŸÐµÑ€Ð½ÐµÑ€Ð¾Ð²ÑÑŒÐºÐ¸Ð¹", en="Developer: Matvii Pernerovskyi"},
        ["version"] = {uk="Ð’ÐµÑ€ÑÑ–Ñ ÑÐ¸ÑÑ‚ÐµÐ¼Ð¸: 4.1", en="System version: 4.1"},
        ["update_info"] = {uk="ÐžÐ½Ð¾Ð²Ð»ÐµÐ½Ð½Ñ 4.1: ÐŸÐ¾ÐºÑ€Ð°Ñ‰ÐµÐ½Ð¾ ÑÑ‚Ð¸Ð»ÑŒ Ð¿Ñ€Ð¾Ð³Ñ€Ð°Ð¼ ÐŸÑ€Ð¾Ð²Ñ–Ð´Ð½Ð¸Ðº Ñ‚Ð° ÐÐ¾Ñ‚Ð°Ñ‚ÐºÐ¸", en="Update 4.1: Improved style of File Explorer and Notes"},
        ["enter_command"] = {uk="Ð’Ð²ÐµÐ´Ð¸ ÐºÐ¾Ð¼Ð°Ð½Ð´Ñƒ: ", en="Enter command: "},
        ["settings_color"] = {uk="1. Ð—Ð¼Ñ–Ð½Ð¸Ñ‚Ð¸ ÐºÐ¾Ð»Ñ–Ñ€ Ñ‚ÐµÐºÑÑ‚Ñƒ", en="1. Change text color"},
        ["settings_sound"] = {uk="2. Ð£Ð²Ñ–Ð¼ÐºÐ½ÑƒÑ‚Ð¸/Ð²Ð¸Ð¼ÐºÐ½ÑƒÑ‚Ð¸ Ð·Ð²ÑƒÐº", en="2. Toggle sound"},
        ["settings_language"] = {uk="3. Ð—Ð¼Ñ–Ð½Ð¸Ñ‚Ð¸ Ð¼Ð¾Ð²Ñƒ (uk/en)", en="3. Change language (uk/en)"},
        ["calc_prompt1"] = {uk="Ð§Ð¸ÑÐ»Ð¾ 1: ", en="Number 1: "},
        ["calc_prompt2"] = {uk="ÐžÐ¿ÐµÑ€Ð°Ñ†Ñ–Ñ (+ - * /): ", en="Operation (+ - * /): "},
        ["calc_prompt3"] = {uk="Ð§Ð¸ÑÐ»Ð¾ 2: ", en="Number 2: "},
        ["calc_result"] = {uk="Ð ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚: ", en="Result: "},
        ["games_rps"] = {uk="ÐšÐ°Ð¼Ñ–Ð½ÑŒ-Ð½Ð¾Ð¶Ð¸Ñ†Ñ–-Ð¿Ð°Ð¿Ñ–Ñ€", en="Rock-Paper-Scissors"},
        ["rps_prompt"] = {uk="Ð¢Ð²Ñ–Ð¹ Ð²Ð¸Ð±Ñ–Ñ€: ", en="Your choice: "},
        ["rps_computer"] = {uk="ÐšÐ¾Ð¼Ð¿'ÑŽÑ‚ÐµÑ€ Ð²Ð¸Ð±Ñ€Ð°Ð²: ", en="Computer chose: "},
        ["rps_win"] = {uk="Ð¢Ð¸ Ð²Ð¸Ð³Ñ€Ð°Ð²!", en="You win!"},
        ["rps_lose"] = {uk="Ð¢Ð¸ Ð¿Ñ€Ð¾Ð³Ñ€Ð°Ð²!", en="You lose!"},
        ["rps_draw"] = {uk="ÐÑ–Ñ‡Ð¸Ñ!", en="Draw!"}
    }
    return t[key][settings.language]
end

-- Ð“Ð¾Ð»Ð¾Ð²Ð½Ðµ Ð¼ÐµÐ½ÑŽ
function mainMenu()
    while true do
        print("\n==============================")
        colorPrint("        "..text("main_title").."       ")
        print("==============================\n")
        print("settings - "..text("menu_settings"))
        print("calc - "..text("menu_calc"))
        print("info - "..text("menu_info"))
        print("games - "..text("menu_games"))
        print("files - "..text("menu_files"))
        print("notes - "..text("menu_notes").."\n")
        io.write(text("enter_command"))
        local cmd = io.read()
        if cmd == "settings" then
            settingsMenu()
        elseif cmd == "calc" then
            calculator()
        elseif cmd == "info" then
            systemInfo()
        elseif cmd == "games" then
            miniGames()
        elseif cmd == "files" then
            fileExplorer()
        elseif cmd == "notes" then
            notesApp()
        else
            print(text("cmd_invalid"))
        end
    end
end

-- ÐÐ°Ð»Ð°ÑˆÑ‚ÑƒÐ²Ð°Ð½Ð½Ñ
function settingsMenu()
    while true do
        print("\n------ "..text("menu_settings").." ------\n")
        print(text("settings_color"))
        print(text("settings_sound"))
        print(text("settings_language"))
        print(text("back").."\n")
        io.write(text("enter_command"))
        local cmd = io.read()
        if cmd == "1" then
            io.write("Ð’Ð²ÐµÐ´Ð¸ ÐºÐ¾Ð»Ñ–Ñ€ Ñ‚ÐµÐºÑÑ‚Ñƒ: ")
            local color = io.read()
            settings.textColor = color
        elseif cmd == "2" then
            settings.sound = not settings.sound
            print("Ð—Ð²ÑƒÐº / Sound:", settings.sound and "On / Ð£Ð²Ñ–Ð¼ÐºÐ½ÐµÐ½Ð¾" or "Off / Ð’Ð¸Ð¼ÐºÐ½ÐµÐ½Ð¾")
        elseif cmd == "3" then
            io.write("Ð’Ð²ÐµÐ´Ð¸ Ð¼Ð¾Ð²Ñƒ (uk/en): ")
            local lang = io.read()
            if lang == "uk" or lang == "en" then
                settings.language = lang
                print("ÐœÐ¾Ð²Ð° Ð·Ð¼Ñ–Ð½ÐµÐ½Ð° / Language changed: "..lang)
            else
                print(text("cmd_invalid"))
            end
        elseif cmd == "back" then
            break
        else
            print(text("cmd_invalid"))
        end
    end
end

-- ÐšÐ°Ð»ÑŒÐºÑƒÐ»ÑÑ‚Ð¾Ñ€
function calculator()
    while true do
        print("\n------ "..text("menu_calc").." ------\n")
        print(text("back"))
        io.write(text("calc_prompt1"))
        local a = io.read()
        if a == "back" then break end
        a = tonumber(a)
        io.write(text("calc_prompt2"))
        local op = io.read()
        io.write(text("calc_prompt3"))
        local b = io.read()
        if b == "back" then break end
        b = tonumber(b)
        local result
        if op == "+" then result = a + b
        elseif op == "-" then result = a - b
        elseif op == "*" then result = a * b
        elseif op == "/" then result = a / b
        else
            print(text("cmd_invalid"))
        end
        if result then print(text("calc_result")..result) end
    end
end

-- Ð†Ð½Ñ„Ð¾Ñ€Ð¼Ð°Ñ†Ñ–Ñ Ð¿Ñ€Ð¾ ÑÐ¸ÑÑ‚ÐµÐ¼Ñƒ
function systemInfo()
    while true do
        print("\n------ "..text("menu_info").." ------\n")
        print(text("developer"))
        print(text("version"))
        print(text("update_info"))
        print(text("back"))
        local cmd = io.read()
        if cmd == "back" then break end
    end
end

-- ÐœÑ–Ð½Ñ–-Ñ–Ð³Ñ€Ð¸
function miniGames()
    while true do
        print("\n------ "..text("menu_games").." ------\n")
        print("1. "..text("games_rps"))
        print(text("back").."\n")
        io.write(text("enter_command"))
        local cmd = io.read()
        if cmd == "1" then
            rockPaperScissors()
        elseif cmd == "back" then
            break
        else
            print(text("cmd_invalid"))
        end
    end
end

-- ÐšÐ°Ð¼Ñ–Ð½ÑŒ-Ð½Ð¾Ð¶Ð¸Ñ†Ñ–-Ð¿Ð°Ð¿Ñ–Ñ€
function rockPaperScissors()
    local options = {"ÐºÐ°Ð¼Ñ–Ð½ÑŒ", "Ð½Ð¾Ð¶Ð¸Ñ†Ñ–", "Ð¿Ð°Ð¿Ñ–Ñ€"}
    print("\n"..text("games_rps").." ("..text("back")..")")
    while true do
        io.write(text("rps_prompt"))
        local player = io.read()
        if player == "back" then break end
        local computer = options[math.random(1,3)]
        print(text("rps_computer")..computer)
        if player == computer then
            print(text("rps_draw"))
        elseif (player=="ÐºÐ°Ð¼Ñ–Ð½ÑŒ" and computer=="Ð½Ð¾Ð¶Ð¸Ñ†Ñ–") or
               (player=="Ð½Ð¾Ð¶Ð¸Ñ†Ñ–" and computer=="Ð¿Ð°Ð¿Ñ–Ñ€") or
               (player=="Ð¿Ð°Ð¿Ñ–Ñ€" and computer=="ÐºÐ°Ð¼Ñ–Ð½ÑŒ") then
            print(text("rps_win"))
        else
            print(text("rps_lose"))
        end
    end
end

-- ÐŸÑ€Ð¾Ð²Ñ–Ð´Ð½Ð¸Ðº
function fileExplorer()
    print("ðŸ—‚ï¸  ÐŸÑ€Ð¾Ð²Ñ–Ð´Ð½Ð¸Ðº")
    local filesystem = {
        ["Ð—Ð¾Ð±Ñ€Ð°Ð¶ÐµÐ½Ð½Ñ"] = {
            ["ÐÑ€Ñ‚ 1"] = [[
 /\_/\  
( o.o ) 
 > ^ <
            ]],
            ["ÐÑ€Ñ‚ 2"] = [[
  |\_/|
  |o o|
  ( T )
            ]]
        },
        ["Ð”Ð¾ÐºÑƒÐ¼ÐµÐ½Ñ‚Ð¸"] = {
            ["Ð’Ñ–Ñ€Ñˆ 1"] = [[
Ð Ð°Ð½Ð¾Ðº Ð½Ð°ÑÑ‚Ð°Ð², Ñ– ÑÐ¾Ð½Ñ†Ðµ Ð²ÑÑ‚Ð°Ñ”,
Ð¡Ð²Ñ–Ñ‚ Ð½Ð°Ð²ÐºÐ¾Ð»Ð¾ Ð³Ñ€Ð°Ñ”, Ð¾Ð¶Ð¸Ð²Ð°Ñ”.
            ]],
            ["Ð’Ñ–Ñ€Ñˆ 2"] = [[
Ð’Ñ–Ñ‚ÐµÑ€ ÑÐ²Ð¸Ñ‰Ðµ Ñƒ Ð³Ð°ÑŽ,
Ð›Ð¸ÑÑ‚Ñ Ñ‚Ð°Ð½Ñ†ÑŽÑ” Ð² Ñ€Ð°ÑŽ.
            ]]
        }
    }

    local function browse(folder)
        while true do
            print("\nðŸ“ ÐŸÐ°Ð¿ÐºÐ°: "..folder.." ("..text("back")..")")
            local items = filesystem[folder]
            local i = 1
            local indexMap = {}
            for name, _ in pairs(items) do
                print("  "..i..". "..name)
                indexMap[i] = name
                i = i + 1
            end
            io.write("Ð’Ð²ÐµÐ´Ð¸ Ð½Ð¾Ð¼ÐµÑ€ Ñ„Ð°Ð¹Ð»Ñƒ: ")
            local choice = io.read()
            if choice == "back" then break end
            if indexMap[tonumber(choice)] then
                print("\n=== "..indexMap[tonumber(choice)].." ===")
                print(items[indexMap[tonumber(choice)]])
            else
                print(text("cmd_invalid"))
            end
        end
    end

    while true do
        print("\nðŸ“‚ ÐšÐ¾Ñ€ÐµÐ½ÐµÐ²Ð° Ð¿Ð°Ð¿ÐºÐ° ("..text("back").."):")
        local i = 1
        local folders = {}
        for name, _ in pairs(filesystem) do
            print("  "..i..". "..name)
            folders[i] = name
            i = i + 1
        end
        io.write("Ð’Ð²ÐµÐ´Ð¸ Ð½Ð¾Ð¼ÐµÑ€ Ð¿Ð°Ð¿ÐºÐ¸: ")
        local choice = io.read()
        if choice == "back" then break end
        if folders[tonumber(choice)] then
            browse(folders[tonumber(choice)])
        else
            print(text("cmd_invalid"))
        end
    end
end

-- ÐÐ¾Ñ‚Ð°Ñ‚ÐºÐ¸
function notesApp()
    print("ðŸ“‹  ÐÐ¾Ñ‚Ð°Ñ‚ÐºÐ¸")
    local tasks = {}

    while true do
        print("\nÐ¡Ð¿Ð¸ÑÐ¾Ðº Ð´Ñ–Ð¹ ("..text("back").."):")
        print("  1 - Ð”Ð¾Ð´Ð°Ñ‚Ð¸ ÑÐ¿Ñ€Ð°Ð²Ñƒ")
        print("  2 - ÐŸÐµÑ€ÐµÐ³Ð»ÑÐ½ÑƒÑ‚Ð¸ ÑÐ¿Ð¸ÑÐ¾Ðº ÑÐ¿Ñ€Ð°Ð²")
        print("  3 - Ð’Ð¸Ð´Ð°Ð»Ð¸Ñ‚Ð¸ ÑÐ¿Ñ€Ð°Ð²Ñƒ")
        io.write("Ð’Ð²ÐµÐ´Ð¸ ÐºÐ¾Ð¼Ð°Ð½Ð´Ñƒ: ")
        local choice = io.read()

        if choice == "back" then
            break
        elseif choice == "1" then
            io.write("Ð’Ð²ÐµÐ´Ð¸ Ð½Ð°Ð·Ð²Ñƒ ÑÐ¿Ñ€Ð°Ð²Ð¸: ")
            local task = io.read()
            table.insert(tasks, task)
            print("âœ… Ð”Ð¾Ð´Ð°Ð½Ð¾: "..task)
        elseif choice == "2" then
            if #tasks == 0 then
                print("Ð¡Ð¿Ð¸ÑÐ¾Ðº ÑÐ¿Ñ€Ð°Ð² Ð¿Ð¾Ñ€Ð¾Ð¶Ð½Ñ–Ð¹.")
            else
                print("Ð¢Ð²Ð¾Ñ— ÑÐ¿Ñ€Ð°Ð²Ð¸:")
                for i, t in ipairs(tasks) do
                    print("  "..i..". "..t)
                end
            end
        elseif choice == "3" then
            if #tasks == 0 then
                print("ÐÐµÐ¼Ð°Ñ” Ñ‡Ð¾Ð³Ð¾ Ð²Ð¸Ð´Ð°Ð»ÑÑ‚Ð¸.")
            else
                print("Ð¯ÐºÑƒ ÑÐ¿Ñ€Ð°Ð²Ñƒ Ð²Ð¸Ð´Ð°Ð»Ð¸Ñ‚Ð¸? Ð’Ð²ÐµÐ´Ð¸ Ð½Ð¾Ð¼ÐµÑ€ Ð°Ð±Ð¾ 'back':")
                for i, t in ipairs(tasks) do
                    print("  "..i..". "..t)
                end
                local num = io.read()
                if num == "back" then
                else
                    num = tonumber(num)
                    if num and tasks[num] then
                        print("âŒ Ð’Ð¸Ð´Ð°Ð»ÐµÐ½Ð¾: "..tasks[num])
                        table.remove(tasks, num)
                    else
                        print(text("cmd_invalid"))
                    end
                end
            end
        else
            print(text("cmd_invalid"))
        end
    end
end

-- Ð¡Ñ‚Ð°Ñ€Ñ‚ ÑÐ¸ÑÑ‚ÐµÐ¼Ð¸
mainMenu()
